# language: ru
Функция: Тестирование производительности системы
  Как разработчик
  Я хочу убедиться что система работает быстро
  Чтобы обеспечить хороший пользовательский опыт

  Сценарий: Загрузка большого количества резюме
    Когда я создаю 10000 тестовых резюме
    И загружаю страницу со списком резюме
    Тогда страница должна загрузиться менее чем за 2 секунды
    И пагинация должна работать корректно
    И поиск должен выполняться менее чем за 500 мс

  Сценарий: Одновременная работа пользователей
    Когда 100 пользователей одновременно:
      | действие                      | количество |
      | просматривают резюме          | 40         |
      | редактируют резюме            | 30         |
      | создают новые резюме          | 20         |
      | выполняют поиск               | 10         |
    Тогда среднее время отклика должно быть менее 1 секунды
    И не должно быть ошибок 500
    И все транзакции должны завершиться успешно

  Структура сценария: Производительность операций с хранилищем
    Когда я выполняю "<операция>" над "<количество>" резюме
    Тогда операция должна завершиться за менее чем "<время>" мс

    Примеры:
      | операция           | количество | время  |
      | сохранение         | 1          | 50     |
      | сохранение         | 100        | 1000   |
      | загрузка           | 1          | 20     |
      | загрузка           | 1000       | 500    |
      | поиск по UUID      | 1          | 10     |
      | полнотекстовый поиск| 10000     | 1000   |

  Сценарий: Кэширование данных
    Дано кэш очищен
    Когда я первый раз загружаю резюме ID=123
    Тогда время загрузки составляет X мс
    Когда я повторно загружаю резюме ID=123
    Тогда время загрузки должно быть менее 0.1*X мс
    И данные должны быть взяты из кэша

  Сценарий: Оптимизация запросов к базе данных
    Когда я загружаю страницу с резюме и всеми связанными данными
    Тогда должно быть выполнено не более 5 SQL запросов
    И не должно быть N+1 проблем
    И все запросы должны использовать индексы

  Сценарий: Утечки памяти
    Дано начальное использование памяти зафиксировано
    Когда я выполняю 1000 циклов создания и удаления резюме
    Тогда использование памяти не должно увеличиться более чем на 10%
    И не должно быть утечек памяти
    И сборщик мусора должен освобождать память